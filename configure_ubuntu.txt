git clone https://github.com/ManeskinDaloro/lab8.git

Установка MS SQL SERVER.
sudo sudo
apt update && apt upgrade
lsb_release -a

В репозиториях Ubuntu нет сервера MS SQL. Для начала импортируем GPG-ключ для репозитория:
	wget -qO- https://packages.microsoft.com/keys/microsoft.asc | apt-key add -
	
add-apt-repository "$(wget -qO- https://packages.microsoft.com/config/ubuntu/18.04/mssql-server-2017.list)"
apt-get install mssql-server 
sudo /opt/mssql/bin/mssql-conf setup

systemctl status mssql-server
systemctl enable mssql-server

Устанавливаем средства для создания и управления бд:
curl https://packages.microsoft.com/keys/microsoft.asc | apt-key add -
curl https://packages.microsoft.com/config/ubuntu/18.04/prod.list | tee /etc/apt/sources.list.d/msprod.list
apt-get install mssql-tools
echo 'export PATH="$PATH:/opt/mssql-tools/bin"' >> ~/.bashrc
export PATH="$PATH:/opt/mssql-tools/bin"

Пробуем подключиться:
sqlcmd -S localhost -U SA
SELECT name FROM master.dbo.sysdatabases
GO

Восстанавливаем БД:
CREATE MASTER KEY ENCRYPTION BY PASSWORD = 'VeryStrong';

CREATE CERTIFICATE ECert
  FROM FILE = N'H:\SQLDEVELOPER\MSSQL15.MSSQLSERVER\MSSQL\Backup\ECert.crt'
  WITH PRIVATE KEY ( 
    FILE = N'H:\SQLDEVELOPER\MSSQL15.MSSQLSERVER\MSSQL\Backup\ECert.key',
 DECRYPTION BY PASSWORD = 'strong'
  );

RESTORE HEADERONLY FROM DISK = 'H:\SQLDEVELOPER\MSSQL15.MSSQLSERVER\MSSQL\Backup\lab_8_1.bak';
RESTORE FILELISTONLY FROM DISK = 'H:\SQLDEVELOPER\MSSQL15.MSSQLSERVER\MSSQL\Backup\lab_8_1.bak'

RESTORE DATABASE lab_8_1 FROM DISK = 'H:\SQLDEVELOPER\MSSQL15.MSSQLSERVER\MSSQL\Backup\lab_8_1.bak' WITH FILE = 1,
	MOVE N'lab_8_1' TO N'H:\SQLDEVELOPER\MSSQL15.MSSQLSERVER\MSSQL\DATA\lab_8_1.mdf',
	MOVE N'lab_8_1_log' TO N'H:\SQLDEVELOPER\MSSQL15.MSSQLSERVER\MSSQL\DATA\lab_8_1_log.ldf';

SELECT name, is_encrypted FROM sys.databases;
SELECT * FROM lab_8_1.dbo.Employee;


